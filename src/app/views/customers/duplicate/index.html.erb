<% breadcrumb :root %>
<div id="customer_duplicate_index">
  <p class="common_title">重複顧客一覧</p>
  
  <div class="pl-2 mt-3">
    <% if @duplicate_customers.present? %>
      <h5>合計件数：<%= @duplicate_customers.total_count %>件</h5>
    <% end %>
  </div>
  <div class="lower-frame">
    <% if @duplicate_customers.blank? %>
      <p>該当データがありません</p>
    <% else %>
      <table class="table">
        <thead class="thead-light">
          <tr>
            <th scope="col">顧客ID</th>
            <th scope="col">FMID</th>
            <th scope="col">氏名</th>
            <th scope="col">シメイ</th>
            <th scope="col">TEL</th>
            <th class="address" scope="col">住所</th>
            <th scope="col">Email</th>
            <th scope="col">個性</th>
            <th scope="col">サイズ</th>
            <th scope="col">診察券</th>
            <th scope="col">初回ご来店日</th>
            <th scope="col"></th>
          </tr>
        </thead>
        <tbody>
          <% @duplicate_customers.each_with_index do |customer, i|%>
            <tr>
              <td scope="row"><%= customer.id %></td>
              <td scope="row"><%= customer.fmid %></td>
              <td><%= customer.last_name + customer.first_name %></td>
              <% if @duplicate_index_list.include?(i) %>
                <td rowspan="<%= @duplicate_index_list[@duplicate_index_list.index { |index| i === index } + 1] - @duplicate_index_list[@duplicate_index_list.index { |index| i === index }] %>"><%= customer.last_kana + customer.first_kana %></td>
                <td rowspan="<%= @duplicate_index_list[@duplicate_index_list.index { |index| i === index } + 1] - @duplicate_index_list[@duplicate_index_list.index { |index| i === index }] %>"><%= customer.tel %></td>
              <% end %>
              <td class="address"><%= customer.address %></td>
              <td><%= customer.email %></td>
              <td><%= customer.zoomancy.name if customer.zoomancy.present? %></td>
              <td><%= customer.size_name %></td>
              <td><%= customer.has_registration_card == true ? '有' : '無' %></td>
              <td><%= customer.first_visited_at %></td>
              <td>
                <ul>
                  <li><%= link_to '詳細へ', customer_path(customer.id) %></li>
                  <li><%= link_to '予約登録へ', new_reservation_path(customer_id: customer.id) %></li>
                </ul>
              </td>
            </tr>
          <%end%>
        </tbody>
      </table>
    <% end %>
  </div>
  <%= paginate @duplicate_customers if @duplicate_customers.present? %>
  <br>
  <br>
</div>
